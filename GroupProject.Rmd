---
title: "GroupProject"
runtime: shiny
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
function(input, output) {

  # You can access the value of the widget with input$file, e.g.
  output$value <- renderPrint({
    str(input$file)
  })

}

fluidPage(
    
  # Copy the line below to make a file upload manager
  fileInput("file", label = h3("File input")),
  
  hr(),
  fluidRow(column(4, verbatimTextOutput("value")))
  
)
```

```{r}
library(ISwR)
library(TTR)
library(readr)

A2010 <- read.csv("BP Apprehensions 2010.csv", header = TRUE, stringsAsFactors = FALSE)
A2017 <- read.csv("PB Apprehensions 2017.csv", header = TRUE, stringsAsFactors = FALSE)

```
##Compare by sector
```{r}
yearA <- as.data.frame(matrix(c(rowSums(A2010[,-1])),nrow = 1))

colnames(yearA) <- A2010[,1]

yearB<- as.data.frame(matrix(c(rowSums(A2017[,-1])),nrow = 1))

colnames(yearB) <- A2010[,1]

yearAB <- rbind(yearA, yearB)

row.names(yearAB) <- c("year2010", "year2017")

barplot(as.matrix(yearAB), beside = TRUE, col = c("red", "blue"), bty="n" )

legend("topleft", c("year2010","year2017"), pch=15,  col=c("red","blue"),  bty="n")

```

##Compare by month
```{r}
yearA1 <- as.data.frame(matrix(c(colSums(A2010[,-1])),nrow = 1))

colnames(yearA1) <- c(10:12,1:9)

yearB1<- as.data.frame(matrix(c(colSums(A2017[,-1])),nrow = 1))

colnames(yearB1) <- c(10:12,1:9)

yearAB1 <- rbind(yearA1, yearB1)

row.names(yearAB1) <- c("year2010", "year2017")

barplot(as.matrix(yearAB1), beside = TRUE, col = c("red", "blue"), bty="n" )

legend("topleft", c("year2010","year2017"), pch=15,  col=c("red","blue"),  bty="n")
```

##t.test
```{r}
a<-as.numeric(which.max(yearA))
b<-as.numeric(which.max(yearB))
t.test(as.numeric(A2010[a,-1]), as.numeric(A2017[b,-1]), paired = FALSE)
```

Assume 95% confidence level, the p-value 0.06346 is bigger than 0.05,
So, we do not reject H0 which states there is no change in the means
of the most apprehension sectors of 2010 and 2017. In conclusion, we
are 95% confident to say that there is a change between two means.


##Find the three months with most apprehension of 2010 and 2017
```{r}
sum2010 <- runSum(as.numeric(yearA1),n = 3, cumulative = FALSE)
sum2017 <- runSum(as.numeric(yearB1),n = 3, cumulative = FALSE)
max(sum2010,na.rm = T)
max(sum2017,na.rm = T)
which.max(sum2010)
which.max(sum2017)
```



The three months period with the most apprehension of 2010 is March,
April, and May, with the sum 163643. 
The three months period with the most apprehension of 2017 is October,
November, and December, with the sum 136646.
The sum of 2010 is bigger than the sum of 2017


##Time series
```{r}
ts1 <- read_csv("NEW PB monthly summaries.csv", col_names = FALSE)

ts2 <- as.vector(t(ts1))
ts2 <- rev(ts2)

ts3 <- ts(ts2, start = c(2000,10), frequency=12)

ts.plot(ts3, gpars=list(xlab="year", ylab="Apprehensions", lty=c(1:3)))
```

install.packages('rsconnect')
# Rely on the 'WorldPhones' dataset in the datasets
# package (which generally comes preloaded).
library(datasets)

# Define a server for the Shiny app
function(input, output) {
  
  # Fill in the spot we created for a plot
output$phonePlot <- renderPlot({
    
    # Render a barplot
    barplot(WorldPhones[,input$region]*1000, 
            main=input$region,
            ylab="Number of Telephones",
            xlab="Year")
  })
}





